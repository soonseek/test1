# 코드 사양 (Code Specification)

**Task ID**: task-1-1-5
**제목**: API Route 응답 구성 및 에러 처리

이 문서는 Next.js 14+ App Router 환경에서 PokeAPI 데이터를 프록시하고 클라이언트에 제공하기 위한 API Route의 사양을 정의합니다.

---

### 파일: `src/types/pokemon.ts`
---
설명: PokeAPI의 원본 응답과 우리 애플리케이션에서 사용할 변환된 데이터 형태를 정의하는 타입 스크립트 인터페이스입니다.
- `PokeAPIListResponse`: PokeAPI v2 `pokemon?limit=...` 엔드포인트의 원본 응답 구조 정의 (`count`, `next`, `previous`, `results`)
- `PokemonListItem`: 클라이언트로 반환할 간소화된 데이터 구조 정의 (`id`, `name`, `url`)
- `APIError`: 에러 응답을 위한 공통 구조 정의 (`success`, `message`)

### 파일: `src/lib/utils/pokemon.ts`
---
설명: PokeAPI의 데이터를 클라이언트에 맞게 변환하고 포맷팅하는 유틸리티 함수 모음입니다.
- `formatPokemonList(apiResponse)`: PokeAPI 리스트 응답을 받아 `results` 배열을 순회하며 URL에서 ID를 추출하고, 필요한 필드만 매핑하여 반환하는 함수
- `extractIdFromUrl(url)`: URL 문자열(예: `https://pokeapi.co/api/v2/pokemon/1/`)에서 숫자 ID를 추출하는 헬퍼 함수

### 파일: `src/app/api/pokemon/route.ts`
---
설명: 포켓몬 목록 데이터를 제공하는 GET 핸들러입니다. 서버 사이드에서 PokeAPI를 호출하고, 성공 시 JSON 응답을 반환하며 실패 시 적절한 에러 상태 코드를 반환합니다.
- **HTTP Method**: `GET`
- **Query Parameters**: `limit` (기본값: 20), `offset` (기본값: 0)
- **Fetch 로직**: `fetch('https://pokeapi.co/api/v2/pokemon')` 호출 및 타입 변환
- **성공 시 (200 OK)**: `NextResponse.json()`을 사용하여 변환된 데이터(`{ data: PokemonListItem[] }`) 반환
- **실패 시**:
  - PokeAPI 호출 실패 또는 타임아웃: `500 Internal Server Error` 및 에러 메시지 반환
  - 잘못된 쿼리 파라미터: `400 Bad Request` 반환
- **보안**: `NextResponse` 헤더 설정을 통해 CORS 및 캐시 제어(예: `public, max-age=60`) 고려