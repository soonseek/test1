# 코드 사양 (Code Specification)

**Task ID**: task-1-1-7
**제목**: 로컬 개발 환경에서 데이터 페칭 테스트

이 사양은 Next.js 14+ App Router 환경에서 PokeAPI 데이터를 안전하게 가져오고, 캐싱 전략을 적용하며, 이를 검증하기 위한 테스트 페이지를 구축하는 데 중점을 둡니다.

---

### 파일: `src/lib/api/pokemon.ts`
---
설명: PokeAPI v2와 통신하여 데이터를 가져오는 핵심 로직을 담당하는 모듈입니다. 외부 API 호출을 캡슐화하고 타입 안전성을 보장합니다.
- `PokemonListResponse`, `PokemonListItem` 인터페이스를 정의합니다. (이름, URL 필드 포함)
- `getPokemonList(offset: number, limit: number)` 함수를 export 합니다.
- 내부적으로 `fetch('https://pokeapi.co/api/v2/pokemon')`를 호출합니다.
- Next.js의 `fetch` 옵션으로 `next: { revalidate: 3600 }`을 설정하여 1시간 동안 데이터 캐싱을 적용합니다.
- 네트워크 에러 발생 시 에러를 던지도록 처리합니다.

### 파일: `src/app/api/pokemon/route.ts`
---
설명: 클라이언트 또는 서버 컴포넌트에서 데이터 페칭 로직을 간접적으로 호출하거나, 추후 프록시/가공이 필요할 경우를 대비한 API 라우트입니다. (현재 태스크에서는 서버 액션 직접 호출도 가능하나, 레이어 분리 목적상 작성)
- HTTP GET 메서드를 처리합니다.
- 쿼리 파라미터(`offset`, `limit`)를 받아 `getPokemonList` 함수를 호출합니다.
- JSON 형식으로 데이터를 반환합니다.
- CORS 및 에러 핸들링을 수행합니다.

### 파일: `src/app/debug/test-fetch/page.tsx`
---
설명: 데이터 페칭 로직이 정상적으로 작동하는지 시각적으로 확인하기 위한 전용 테스트 페이지입니다.
- Next.js Server Component로 작성합니다.
- 컴포넌트 진입 시 즉시 `getPokemonList(0, 20)`을 호출합니다.
- 반환된 데이터를 기반으로 간단한 목록(UI)을 렌더링합니다.
- 데이터 로딩 중일 때와 에러 발생 시의 상태를 구분하여 표시합니다.
- 캐싱이 제대로 되었는지 확인하기 위해 페이지의 타이틀과 현재 시간을 표시합니다.

### 파일: `src/types/pokemon.ts`
---
설명: 포켓몬 관련 데이터 구조를 애플리케이션 전역에서 일관되게 사용하기 위한 타입 정의 파일입니다.
- `PokemonListItem` 타입 (name: string, url: string)
- `PokemonListResponse` 타입 (count: number, next: string | null, previous: string | null, results: PokemonListItem[])
- 추후 확장을 위해 별도 파일로 분리하여 관리합니다.

### 파일: `prisma/schema.prisma`
---
설명: 데이터베이스 구조를 정의합니다. 이번 태스크는 외부 API 캐싱이 주 목적이나, 향후 DB 연동(Story 1-1의 기술 노트)을 대비해 스키마를 준비합니다.
- `PokemonCache` 모델을 정의합니다 (선택 사항: 만약 DB 캐싱을 구현한다면).
- 필드: `id` (Int, @id), `data` (Json), `updatedAt` (DateTime).
- **참고**: 이번 태스크에서는 Next.js의 `force-cache`/`revalidate`가 우선되므로, Prisma 스키마는 정의만 해두고 실제 쿼리 로직은 다음 스토리에서 구현해도 무방합니다.