# 코드 사양 (Code Specification)

**Task ID**: task-1-1-3
**제목**: PokeAPI 리스트 페칭 로직 구현
**작성자**: Next.js 14+ Full-Stack Architect

---

## 개요
이 문서는 PokeAPI의 데이터를 안전하게 가져오고, 타입 안전성을 보장하며, 향후 캐싱 및 데이터베이스 연동(Story 1-1의 인수 조건 및 FR-005 대응)을 고려한 파일 구조를 정의합니다.

---

### 파일: src/types/pokemon.ts
---
설명: PokeAPI의 응답 데이터 구조에 맞춰 TypeScript 인터페이스를 정의합니다. 외부 API 데이터를 내부 시스템에서 사용할 수 있는 형태로 보장합니다.
- **PokeApiListItem**: PokeAPI 리스트 응답 내부의 개별 아이템 형태 (`name`, `url`) 정의
- **PokeApiListResponse**: PokeAPI 리스트 전체 응답 형태 (`count`, `next`, `previous`, `results`) 정의
- **PokemonListItem**: 클라이언트로 반환할 최종 데이터 형태 (`id`, `name`) 정의
  - `url` 문자열 파싱을 통해 ID를 추출하는 로직이 여기서 타입적으로 정의됨

### 파일: src/lib/api/pokemon.ts
---
설명: PokeAPI와의 통신을 담당하는 비즈니스 로직 레이어입니다. `route.ts` 핸들러의 무결성을 유지하기 위해 데이터 페칭 및 변환 로직을 분리합니다.
- **getPokemonsFromApi(offset: number, limit: number)**: 비동기 함수 구현
  - `https://pokeapi.co/api/v2/pokemon` 엔드포인트에 fetch 요청
  - Query 파라미터(`offset`, `limit`)를 URL에 추가
  - 응답 데이터를 `PokeApiListResponse` 타입으로 변환
  - 네트워크 에러 발생 시 `Error` 객체 throw
- **mapToPokemonList(items)**: API 응답의 `results` 배열을 클라이언트에 맞게 `PokemonListItem` 형태로 매핑
  - URL에서 ID 추출 로직 포함 (예: `https://pokeapi.co/api/v2/pokemon/1/` -> `id: 1`)

### 파일: src/app/api/pokemon/route.ts
---
설명: 클라이언트의 요청을 받아 서버 사이드 로직을 실행하는 API Route 핸들러입니다.
- **GET 메서드 핸들러 구현**:
  - Request URL에서 쿼리 파라미터(`offset`, `limit`)를 파싱
  - 기본값 설정 (예: `limit=20`, `offset=0`)
  - `lib/api/pokemon.ts`의 `getPokemonsFromApi` 함수 호출
  - 성공 시 JSON 형태로 `PokemonListItem[]` 반환 (HTTP 200)
  - 실패 시 적절한 에러 메시지 반환 (HTTP 500)
- 향후 Prisma(DB 캐싱) 로직이 추가될 진입점 보장

---

## 아키텍처 노트

1.  **레이어 분리 (Layer Separation)**:
    -   `route.ts`: HTTP 프로토콜 처리 (파싱, 응답)
    -   `lib/api/pokemon.ts`: 순수 비즈니스 로직 (API 호출, 데이터 변환)
    -   이를 통해 코드 재사용성을 높이고 테스트를 용이하게 만듭니다.

2.  **타입 안전성 (Type Safety)**:
    -   외부 API(PokeAPI)의 스펙이 변경되더라도 `types/pokemon.ts`에서 타입 에러가 발생하므로 런타임 에러를 사전에 방지할 수 있습니다.

3.  **확장성 (Scalability)**:
    -   향후 Story 1-1의 인수 조건인 "Prisma를 통한 DB 연동"이 추가될 때, `route.ts`에서 `getPokemonsFromApi` 호출 전후에 DB 조회/저장 로직을 쉽게 끼워 넣을 수 있습니다.