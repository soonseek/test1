# 코드 사양 (Code Specification)

**Task ID**: task-1-1-6
**제목**: API Route 로컬 테스트
**목표**: PokeAPI 데이터를 페칭하고 반환하는 Next.js API Route 구현 및 로컬 환경에서의 동작 검증

---

### 파일: src/types/pokemon.ts
---
설명: PokeAPI 응답 데이터 및 변환된 포켓몬 데이터의 형태를 정의하는 TypeScript 인터페이스 모음
- `PokeAPIListResponse`: PokeAPI v2 `pokemon?limit=...` 엔드포인트의 원본 응답 형식 정의 (count, next, previous, results)
- `PokeAPIResult`: results 배열 내부 항목의 형식 정의 (name, url)
- `PokemonListItem`: 클라이언트로 반환할 최종 데이터 형식 정의 (id, name)
- `PokemonListResponse`: API Route가 반환하는 JSON 구조 정의 (results: PokemonListItem[], totalCount)

### 파일: src/lib/api/pokemon.ts
---
설명: PokeAPI 외부 호출을 담당하는 서버 사이드 유틸리티 함수
- `fetchPokemonList(offset: number, limit: number)` 함수 구현
- 내부적으로 `fetch` (Next.js built-in) 사용하여 `https://pokeapi.co/api/v2/pokemon` 요청
- 받아온 URL에서 ID를 추출하는 로직 포함 (예: url에서 정수 파싱)
- 데이터 변환 로직: PokeAPIResult -> PokemonListItem 매핑
- 네트워크 에러 발생 시 Error 객체 throw

### 파일: src/app/api/pokemons/route.ts
---
설명: 클라이언트의 요청을 받아 포켓몬 리스트 데이터를 반환하는 Next.js API Route 핸들러
- HTTP GET 메서드 핸들러 구현 (`export async function GET`)
- URL 쿼리 파라미터(`offset`, `limit`) 파싱 및 기본값 설정 (기본값: offset 0, limit 20)
- 파싱된 파라미터를 사용하여 `lib/api/pokemon.ts`의 `fetchPokemonList` 호출
- 성공 시 JSON 형식(`PokemonListResponse`)으로 응답 반환 (Status 200)
- 에러 발생 시 적절한 HTTP 에러 코드 및 에러 메시지 반환 (Status 500)
- CORS 및 헤더 설정 (Next.js 기본값 사용)

### 파일: src/app/api/pokemons/test/route.spec.ts (선택 사항)
---
설명: API Route의 로직이 의도대로 작동하는지 검증하기 위한 테스트 코드 (로컬 테스트 가이드 포함)
- `fetch` 모킹(Mocking)을 통한 외부 API 의존성 제거 테스트 케이스 작성
- 정상 케이스: offset=0, limit=20 요청 시 200 응답과 데이터 구조 검증
- 에러 케이스: 외부 API 실패 시 500 응답 검증
- (참고) 이 파일은 로컬 개발 환경에서의 수동 테스트(Postman 등)를 대체하거나 보완하기 위함임