```markdown
## 파일: prisma/schema.prisma

```prisma
// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model PokemonCache {
  id        Int      @id // PokeAPI의 포켓몬 ID 혹은 캐시 키
  data      Json     // API 응답 전체 데이터를 JSON 형태로 저장
  updatedAt DateTime @updatedAt // 캐시 유효성 판단을 위한 타임스탬프, 자동 업데이트
}
```

## 파일: src/lib/prisma.ts

```typescript
import { PrismaClient } from '@prisma/client';

const globalForPrisma = globalThis as unknown as {
  prisma: PrismaClient | undefined;
};

export const prisma = globalForPrisma.prisma ?? new PrismaClient();

if (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;
```

## 파일: src/lib/api/pokemon.ts

```typescript
import { prisma } from '@/lib/prisma';
import { PokemonListResponse } from '@/types/pokemon';

const POKEAPI_BASE_URL = 'https://pokeapi.co/api/v2';
const CACHE_TTL_MS = 60 * 60 * 1000; // 1시간 (밀리초)

/**
 * 포켓몬 리스트를 가져옵니다.
 * 1. DB 캐시 확인 (유효기간 1시간 이내)
 * 2. 캐시 miss 또는 expired 시 PokeAPI 호출
 * 3. DB upsert 후 반환
 */
export async function getPokemonList(offset: number = 0, limit: number = 20): Promise<PokemonListResponse> {
  // 캐시 키 생성 (예: offset_0_limit_20)
  const cacheKey = offset;
  
  // 1. DB 조회 시도
  const cached = await prisma.pokemonCache.findUnique({
    where: { id: cacheKey },
  });

  const now = new Date();
  
  // 2. 캐시 유효성 검사 (데이터 존재 + 유효기간 내 + 요청한 개수 확인)
  // JSON 데이터에서 results 길이를 확인하여 limit이 변경된 경우를 감지
  if (cached) {
    const cacheData = cached.data as PokemonListResponse;
    const isFresh = now.getTime() - new Date(cached.updatedAt).getTime() < CACHE_TTL_MS;
    const isCorrectLength = cacheData.results && cacheData.results.length === limit;

    if (isFresh && isCorrectLength) {
      console.log('[Cache Hit] Returning data from DB');
      return cacheData;
    }
  }

  console.log('[Cache Miss] Fetching from PokeAPI');

  // 3. PokeAPI 호출
  const response = await fetch(`${POKEAPI_BASE_URL}/pokemon?offset=${offset}&limit=${limit}`);
  
  if (!response.ok) {
    throw new Error('Failed to fetch data from PokeAPI');
  }

  const data: PokemonListResponse = await response.json();

  // 4. DB 저장 (Upsert)
  await prisma.pokemonCache.upsert({
    where: { id: cacheKey },
    update: { data: data as any }, // Prisma Json 타입 업데이트
    create: {
      id: cacheKey,
      data: data as any,
    },
  });

  return data;
}
```

## 파일: src/types/pokemon.ts

```typescript
export interface PokemonListItem {
  name: string;
  url: string;
}

export interface PokemonListResponse {
  count: number;
  next: string | null;
  previous: string | null;
  results: PokemonListItem[];
}

// DB에 저장될 JSON 데이터의 형식 (엄격한 타이핑을 위해 PokemonListResponse와 동일하게 사용 가능)
export type PokemonCacheData = PokemonListResponse;
```

## 파일: src/app/page.tsx

```typescript
import { getPokemonList } from '@/lib/api/pokemon';
import { PokemonGrid } from '@/components/PokemonGrid'; // 컴포넌트가 있다고 가정

export default async function Home() {
  // 초기 데이터 페칭 (DB 캐싱 로직 적용됨)
  const initialData = await getPokemonList(0, 20);

  return (
    <main className="min-h-screen p-8">
      <h1 className="text-4xl font-bold mb-8 text-center">Pokédex</h1>
      {/* 데이터를 컴포넌트에 전달 */}
      <PokemonGrid initialData={initialData} />
    </main>
  );
}
```

## 파일: .env

```env
# PostgreSQL 연결 문자열
DATABASE_URL="postgresql://user:password@localhost:5432/mydb?schema=public"

# PokeAPI 기본 URL (선택 사항, 코드 내 하드코딩 시 생략 가능)
NEXT_PUBLIC_POKEAPI_BASE_URL="https://pokeapi.co/api/v2"
```