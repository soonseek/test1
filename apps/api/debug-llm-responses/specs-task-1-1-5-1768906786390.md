# 코드 사양 (Code Specification)

**Task ID**: task-1-1-5
**제목**: API Route 응답 구성 및 에러 처리
**작성자**: Next.js 14+ Full-Stack Architect

---

## 개요
이 사양은 `task-1-1-5`를 수행하기 위해 필요한 파일 구조와 각 파일의 역할을 정의합니다. 핵심 목표는 **PokeAPI 데이터를 안전하게 가져와서 클라이언트에 JSON 형식으로 반환**하고, **실패 시 적절한 에러 메시지를 반환**하는 Next.js API Route를 구현하는 것입니다.

---

### 파일: src/app/api/pokemon/route.ts
---
설명: 포켓몬 목록 데이터를 제공하는 API Route 핸들러입니다. 클라이언트의 요청을 받아 PokeAPI에서 데이터를 가져오고 가공하여 반환합니다.
- **HTTP 메서드**: `GET`만 지원하며, 그 외 메서드는 405(Method Not Allowed) 반환
- **데이터 페칭**: PokeAPI(`https://pokeapi.co/api/v2/pokemon`)의 `limit` 및 `offset` 쿼리 파라미터를 활용하여 페이지네이션 데이터 요청
- **데이터 가공**: PokeAPI의 원본 응답(`name`, `url`)에서 ID를 추출(`url` 파싱)하여 클라이언트가 사용하기 쉬운 형태의 JSON 배열로 매핑
- **에러 처리**:
  - `fetch` 실패 시(네트워크 에러, 500 등): `console.error` 로깅 후 `NextResponse.json`을 사용해 상태 코드 500과 에러 메시지 반환
  - 예상치 못한 에러 발생 시: `try-catch` 블록으로 감싸 500 Internal Server Error 반환
- **응답 형식**: `NextResponse.json()`을 사용하여 `application/json` 형식의 응답 생성
- **캐싱 전략 (선택 사항)**: `revalidate` 태그 또는 헤더를 설정하여 성능 최적화 고려 (현재 Task는 기본 응답 처리에 집중)

### 파일: src/types/pokemon.ts
---
설명: 포켓몬 데이터의 형태를 정의하는 TypeScript 인터페이스 파일입니다. API Route와 프론트엔드 컴포넌트 간의 데이터 타입 일관성을 보장합니다.
- **PokemonListItem 인터페이스**:
  - `id`: number (포켓몬 고유 ID)
  - `name`: string (포켓몬 이름)
  - `url`: string (상세 조회를 위한 원본 URL)
- **PokeAPIResponse 인터페이스**:
  - `count`: number (전체 개수)
  - `next`: string | null (다음 페이지 URL)
  - `previous`: string | null (이전 페이지 URL)
  - `results`: Array<{ name: string; url: string }> (원본 결과 리스트)

### 파일: src/lib/utils/error.ts
---
설명: API 및 클라이언트에서 발생할 수 있는 에러를 표준화하고 처리하는 유틸리티 함수입니다.
- **ApiError 클래스 (선택 사항)**: 표준 Error 객체를 확장하여 상태 코드(statusCode)를 포함하는 커스텀 에러 클래스 정의
- **handleApiError 함수**:
  - 에러 객체를 받아서 로그를 출력하고
  - 적절한 HTTP 상태 코드와 메시지를 포함한 `NextResponse` 객체를 반환하는 헬퍼 함수

---

## 구현 시 주의사항 (Note)
1. **Next.js Response 객체**: 반드시 `NextResponse.json({ ... }, { status: 200 })` 형태를 사용하여 응답을 생성해야 합니다.
2. **타입 안전성**: `route.ts` 내부에서 `fetch` 호출 후 데이터를 `PokemonListItem` 타입으로 명시적으로 캐스팅하거나 매핑해야 합니다.
3. **환경 변수**: PokeAPI URL 등은 상수로 관리하거나 `.env`에 분리하는 것이 좋으나, 이 Task에서는 코드 내에 상수로 정의하여 구현합니다.