# 코드 사양 (Code Specification)

**Task ID**: task-1-1-6
**제목**: API Route 로컬 테스트
**작성자**: Next.js 14+ Full-Stack Architect

이 문서는 `http://localhost:3000/api/pokemons` 엔드포인트가 정상적으로 동작하도록 하기 위해 필요한 파일들의 사양을 정의합니다. PokeAPI의 데이터를 프록시하고, 타입 안전성을 보장하며, 테스트를 위한 준비 상태를 점검하는 데 중점을 둡니다.

---

### 파일: `src/types/pokemon.ts`
---
설명: PokeAPI의 응답 데이터와 우리 애플리케이션에서 사용할 데이터 형태를 정의하는 타입 스크립트 인터페이스 모음입니다.
- `PokeAPIListResponse`: PokeAPI v2 `pokemon?limit=...` 엔드포인트의 원본 응답 형식 정의 (`count`, `next`, `previous`, `results[]`)
- `PokeAPIListItem`: 리스트 내 개별 아이템 형식 (`name`, `url`)
- `PokemonListItem`: 클라이언트로 반환할 최종 형식 (ID 추출, URL 제거 등 포맷팅)
- `PokemonListResponse`: API Route가 반환할 표준화된 JSON 구조 (`results`, `totalCount`)

### 파일: `src/lib/api/pokemon.ts`
---
설명: PokeAPI와의 통신을 담당하는 비즈니스 로직 레이어입니다. 외부 API 호출을 캡슐화합니다.
- `fetchPokemonList(offset: number, limit: number)` 함수 구현
- 내부적으로 `https://pokeapi.co/api/v2/pokemon`에 fetch 요청 전송
- 받아온 JSON 데이터를 `PokemonListItem` 형태로 매핑 (URL에서 ID 추출 로직 포함)
- 네트워크 에러 발생 시 에러를 throw 하여 Route Handler에서 처리할 수 있도록 함

### 파일: `src/app/api/pokemons/route.ts`
---
설명: 클라이언트(브라우저/Postman)의 요청을 받아 포켓몬 리스트 데이터를 반환하는 Next.js API Route 핸들러입니다.
- `GET` 메서드 핸들러 구현
- URL 쿼리 파라미터(`offset`, `limit`) 파싱 및 기본값 설정 (기본값: offset=0, limit=20)
- 입력값 검증 (숫자 여부, 음수 여부 등)
- `lib/api/pokemon.ts`의 `fetchPokemonList` 함수 호출
- 성공 시 `NextResponse.json()`을 사용하여 200 OK와 함께 JSON 데이터 반환
- 실패 시 적절한 HTTP 에러 코드(400, 500 등)와 에러 메시지 반환

### 파일: `src/app/api/pokemons/route.test.ts` (선택 사항이나 권장)
---
설명: API Route의 로직이 의도대로 동작하는지 자동으로 확인하기 위한 테스트 파일입니다 (로컬 테스트 자동화).
- Jest 또는 Vitest를 사용한 유닛 테스트 작성
- `fetch` 모킹(Mocking)을 통해 외부 API 의존성 제거
- 정상 쿼리 파라미터 전달 시 200 OK와 데이터가 반환되는지 검증
- 잘못된 쿼리 파라미터 전달 시 400 에러가 반환되는지 검증

### 파일: `README_TESTING.md` (또는 프로젝트 문서)
---
설명: 개발자가 로컬 테스트를 수행하는 방법을 명시한 문서입니다.
- 로컬 서버 실행 명령어 (`npm run dev`) 기재
- 테스트 엔드포인트 URL 명시 (`http://localhost:3000/api/pokemons`)
- Postman 또는 Curl 사용 예시 제공
- 예상되는 JSON 응답 샘플 (Success Response) 명시
- 테스트 체크리스트 (데이터 형식, 상태 코드 등) 포함