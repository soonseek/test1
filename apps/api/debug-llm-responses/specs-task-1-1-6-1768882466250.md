# 코드 사양 (Code Specification)

**Task ID**: task-1-1-6
**제목**: API Route 응답 반환 및 에러 처리

이 문서는 Next.js 14+ App Router 환경에서 PokeAPI 데이터를 안전하게 가져오고, 클라이언트에게 표준화된 JSON 형식으로 응답하며, 외부 API 장애 시 우아하게 대처하는 API Route Handler의 사양을 정의합니다.

---

### 파일: `src/app/api/pokemon/[id]/route.ts`
---
설명: 특정 포켓몬 ID(`[id]`)에 대한 상세 정보를 조회하는 API 엔드포인트입니다.
- **HTTP Method**: `GET`
- **파라미터 처리**: URL 파라미터(`params.id`)를 받아와 유효성을 검사합니다.
- **데이터 변환 로직 호출**: `lib/transformer.ts`의 `transformPokemonData` 함수를 사용하여 원본 데이터를 UI에 맞게 가공합니다.
- **성공 응답 (200 OK)**: 가공된 포켓몬 데이터를 JSON 형태로 반환합니다.
- **에러 처리 (Error Handling)**:
  - `404 Not Found`: 파라미터가 누락되었거나 유효하지 않은 경우.
  - `500 Internal Server Error`: PokeAPI 호출 실패 또는 데이터 변환 중 예외 발생 시.
  - 에러 발생 시 클라이언트가 인식할 수 있는 명확한 에러 메시지(JSON)를 반환합니다.

### 파일: `src/lib/api/pokeapi.ts`
---
설명: PokeAPI와의 통신을 담당하는 모듈입니다. (이전 Task에서 생성되었을 수 있으나, 에러 처리를 위해 명시)
- `fetchPokemonDetail(id)` 함수 구현:
  - `fetch`를 사용하여 `https://pokeapi.co/api/v2/pokemon/${id}`를 호출합니다.
  - 응답이 성공적이지 않을 경우(`!res.ok`) 에러를 throw하여 상위 핸들러에서 500 에러가 반환되도록 합니다.
  - 네트워크 연결 실패 등의 예외 상황을 처리합니다.

### 파일: `src/lib/transformer.ts`
---
설명: 원본 PokeAPI 데이터를 프로젝트의 UI 요구사항에 맞게 변환하는 유틸리티 모듈입니다.
- `transformPokemonData(apiData)` 함수 구현:
  - PokeAPI의 복잡한 JSON 구조를 간소화된 구조로 매핑합니다.
  - 예: 이미지 URL 추출, 타입 한글화 매핑(선택 사항), 능력치 데이터 포맷팅.
  - 데이터 누락 시 기본값(default value)을 설정하여 런타임 에러를 방지합니다.

### 파일: `src/types/pokemon.ts`
---
설명: 포켓몬 데이터의 인터페이스를 정의하는 타입 정의 파일입니다.
- `PokemonDetail` 인터페이스 정의:
  - API가 반환할 최종 데이터의 형태를 명시합니다 (예: id, name, types, stats, imageUrl).
  - `ApiError` 인터페이스 정의 (선택 사항):
    - 에러 응답 본문의 형식을 정의합니다 (예: `{ message: string, status: number }`).