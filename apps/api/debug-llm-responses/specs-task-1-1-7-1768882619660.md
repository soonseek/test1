# 코드 사양 (Code Specification)

**Task ID**: task-1-1-7
**제목**: API Route 동작 테스트 (브라우저 또는 Postman)

이 사양은 브라우저 또는 Postman에서 `/api/pokemon` 엔드포인트를 호출하여 데이터가 정상적으로 반환되는지 확인하기 위해 필요한 파일과 로직을 정의합니다. 이는 FR-001(포켓몬 목록 조회) 및 FR-005(데이터 캐싱)의 기반이 되는 백엔드 로직을 구현하는 단계입니다.

---

### 파일: `src/app/api/pokemon/route.ts`
---
설명: 클라이언트의 요청을 받아 포켓몬 목록 데이터를 반환하는 Next.js API Route 핸들러입니다.
- HTTP GET 메서드를 처리합니다.
- 쿼리 파라미터(`offset`, `limit`)를 파싱하고 기본값을 설정합니다.
- `lib/api/pokemon.ts`의 `getPokemonList` 함수를 호출하여 데이터를 가져옵니다.
- 가져온 데이터를 JSON 형식으로 변환하여 반환합니다.
- 에러 발생 시 적절한 HTTP 상태 코드(500)와 에러 메시지를 반환합니다.

### 파일: `src/lib/api/pokemon.ts`
---
설명: PokeAPI와의 통신 및 데이터 캐싱 로직을 담당하는 핵심 비즈니스 로직 모듈입니다.
- `fetchPokemonListFromAPI(offset, limit)` 함수:
  - PokeAPI(`https://pokeapi.co/api/v2/pokemon`)에 fetch 요청을 보냅니다.
  - 응답받은 데이터 중 필요한 필드(id, name, 이미지 URL 등)를 가공하여 반환합니다.
  - 이미지 URL은 공식 artwork URL(`sprites.other['official-artwork'].front_default`)을 사용합니다.
- `getPokemonList(offset, limit)` 함수:
  - (선택 사항) Prisma Client를 사용하여 DB에 캐시된 데이터가 있는지 확인합니다.
  - 캐시가 없거나 만료된 경우 `fetchPokemonListFromAPI`를 호출하고, 결과를 DB에 저장(Cache-Aside)합니다.
  - 최종적으로 포켓몬 목록 데이터를 반환합니다.

### 파일: `src/lib/prisma.ts`
---
설명: Prisma 클라이언트 싱글톤 인스턴스를 생성하고 내보내는 유틸리티 파일입니다.
- 개발 환경에서 핫 리로딩 시 중복 연결을 방지하기 위한 로직을 포함합니다.
- `PrismaClient` 인스턴스를 export 합니다.

### 파일: `prisma/schema.prisma`
---
설명: 데이터베이스 스키마를 정의하는 파일입니다.
- `PokemonCache` 모델을 정의합니다 (FR-005 데이터 캐싱 요구사항).
  - `id`: Int (Primary Key, 포켓몬 ID)
  - `data`: Json (포켓몬 상세 정보 데이터)
  - `updatedAt`: DateTime (캐시 유효성 확인용)

### 파일: `.env`
---
설명: 환경 변수를 정의하는 파일입니다.
- `DATABASE_URL`: PostgreSQL 데이터베이스 연결 문자열을 포함합니다.