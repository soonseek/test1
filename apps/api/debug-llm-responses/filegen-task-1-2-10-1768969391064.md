## 파일: .storybook/main.ts

```typescript
import type { StorybookConfig } from "@storybook/nextjs";

const config: StorybookConfig = {
  stories: ["../src/components/**/*.stories.@(js|jsx|mjs|ts|tsx)"],
  addons: [
    "@storybook/addon-links",
    "@storybook/addon-essentials",
    "@storybook/addon-onboarding",
    "@storybook/addon-interactions",
  ],
  framework: {
    name: "@storybook/nextjs",
    options: {},
  },
  docs: {
    autodocs: "tag",
  },
  webpackFinal: async (config) => {
    // Tailwind CSS 및 shadcn/ui 스타일 처리를 위한 설정
    // Storybook 내부에서 CSS 모듈 및 전역 CSS를 처리하도록 함
    return {
      ...config,
      resolve: {
        ...config.resolve,
        alias: {
          ...config.resolve?.alias,
        },
      },
    };
  },
};

export default config;
```

## 파일: .storybook/preview.ts

```typescript
import type { Preview, ReactRenderer } from "@storybook/react";
import { withThemeByDataAttribute } from "@storybook/addon-themes";
import "../src/app/globals.css"; // 프로젝트의 전역 스타일 로드

/**
 * Storybook 전역 설정
 * - shadcn/ui 테마 지원
 * - Next.js 폰트 및 스타일 적용
 */
const preview: Preview = {
  parameters: {
    actions: { argTypesRegex: "^on[A-Z].*" },
    controls: {
      matchers: {
        color: /(background|color)$/i,
        date: /Date$/i,
      },
    },
    // 뷰포트 레이아웃 설정 (중앙 정렬)
    layout: "centered",
  },
  // 테마 전환 데코레이터 (shadcn/ui의 class 기반 테마 지원)
  decorators: [
    withThemeByDataAttribute<ReactRenderer>({
      themes: {
        light: "light",
        dark: "dark",
      },
      defaultTheme: "light",
      attributeName: "class",
    }),
    (Story) => (
      // shadcn/ui의 스타일이 적용되도록 최소한의 래퍼 클래스 제공
      <div className="font-sans antialiased">
        <Story />
      </div>
    ),
  ],
};

export default preview;
```

## 파일: src/components/pokemon/__tests__/PokemonCard.stories.tsx

```typescript
import type { Meta, StoryObj } from "@storybook/react";
import { PokemonCard } from "../PokemonCard";

// Meta 설정: 컴포넌트의 기본 메타데이터 정의
const meta = {
  title: "Components/Pokemon/PokemonCard",
  component: PokemonCard,
  parameters: {
    layout: "centered",
  },
  tags: ["autodocs"],
  argTypes: {
    // Controls 패널에서 조절 가능한 Props 정의
    id: { control: "number" },
    name: { control: "text" },
    imageUrl: { control: "text" },
    types: { control: "object" },
    isLoading: { control: "boolean" },
  },
} satisfies Meta<typeof PokemonCard>;

export default meta;
type Story = StoryObj<typeof meta>;

// 1. Default: 기본 상태
export const Default: Story = {
  args: {
    id: 25,
    name: "Pikachu",
    imageUrl: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/25.png",
    types: ["Electric"],
    isLoading: false,
  },
};

// 2. Long Name: 이름이 긴 경우 (텍스트 오버플로우 테스트)
export const LongName: Story = {
  args: {
    ...Default.args,
    name: "Mime Jr. This Is A Very Long Name For Testing Overflow",
    id: 439,
    imageUrl: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/439.png",
  },
};

// 3. Missing Image: 이미지가 없는 경우 (Fallback UI 테스트)
export const MissingImage: Story = {
  args: {
    id: 999,
    name: "MissingNo",
    imageUrl: "", // 빈 문자열 또는 잘못된 URL
    types: ["Normal", "Bird"],
    isLoading: false,
  },
};

// 4. Loading: 스켈레톤 UI 상태
export const Loading: Story = {
  args: {
    id: 0,
    name: "Loading...",
    imageUrl: "",
    types: [],
    isLoading: true,
  },
};
```

## 파일: src/components/pokemon/__tests__/PokemonGrid.stories.tsx

```typescript
import type { Meta, StoryObj } from "@storybook/react";
import { PokemonGrid } from "../PokemonGrid";

// Meta 설정
const meta = {
  title: "Components/Pokemon/PokemonGrid",
  component: PokemonGrid,
  parameters: {
    layout: "fullscreen", // 그리드 레이아웃 확인을 위해 전체 화면 사용
  },
  tags: ["autodocs"],
  argTypes: {
    pokemons: { control: "object" },
    isLoading: { control: "boolean" },
  },
} satisfies Meta<typeof PokemonGrid>;

export default meta;
type Story = StoryObj<typeof meta>;

// 더미 데이터 생성 헬퍼 함수
const createPokemon = (id: number, name: string) => ({
  id,
  name,
  imageUrl: `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${id}.png`,
  types: ["Fire"],
});

// 1. Empty State: 데이터가 없는 경우
export const EmptyState: Story = {
  args: {
    pokemons: [],
    isLoading: false,
  },
};

// 2. Single Item: 아이템이 1개일 때 정렬 확인
export const SingleItem: Story = {
  args: {
    pokemons: [createPokemon(1, "Bulbasaur")],
    isLoading: false,
  },
};

// 3. Many Items: 다수의 아이템 (스크롤 및 간격 확인)
export const ManyItems: Story = {
  args: {
    pokemons: Array.from({ length: 24 }, (_, i) =>
      createPokemon(i + 1, `Pokemon ${i + 1}`)
    ),
    isLoading: false,
  },
};

// 4. Responsive: 반응형 확인 (Storybook의 Viewport Addon 사용)
export const Responsive: Story = {
  args: {
    pokemons: Array.from({ length: 10 }, (_, i) =>
      createPokemon(i + 1, `Pokemon ${i + 1}`)
    ),
    isLoading: false,
  },
  parameters: {
    // 뷰포트 크기를 강제로 설정하여 모바일/태블릿/데스크톱 뷰 확인
    viewport: {
      defaultViewport: "iphone12", // 기본값을 모바일로 설정
    },
  },
};
```

## 파일: src/components/pokemon/__tests__/PokemonCard.test.tsx

```typescript
import { render, screen, fireEvent } from "@testing-library/react";
import { PokemonCard } from "../PokemonCard";

describe("PokemonCard Component", () => {
  const mockProps = {
    id: 25,
    name: "Pikachu",
    imageUrl: "https://example.com/pikachu.png",
    types: ["Electric"],
    isLoading: false,
  };

  it("포켓몬 이름과 ID가 문서에 존재하는지 검증", () => {
    render(<PokemonCard {...mockProps} />);

    // 이름이 렌더링되는지 확인
    expect(screen.getByText(/pikachu/i)).toBeInTheDocument();
    
    // ID가 렌더링되는지 확인 (예: #025 형식)
    expect(screen.getByText(/#025/i)).toBeInTheDocument();
  });

  it("이미지 로드 실패(onError) 시 대체 요소가 렌더링되는지 검증", () => {
    // 이미지 로드를 에뮬레이션하기 위해 onError를 스파이하거나
    // 빈 imageUrl을 전달하여 Fallback UI를 확인하는 로직이 필요할 수 있습니다.
    // 여기서는 빈 imageUrl을 전달했을 때의 동작을 가정합니다.
    
    const { container } = render(
      <PokemonCard 
        {...mockProps} 
        imageUrl="" 
      />
    );

    // 이미지 태그가 없거나, 대체 텍스트/아이콘이 나타나는지 확인
    // 구현에 따라 assertion이 달라질 수 있습니다.
    const imgElement = container.querySelector("img");
    
    // 이미지가 없거나 src가 비어있는 상태면 Fallback이 표시되어야 함
    if (imgElement) {
      expect(imgElement).toHaveAttribute("src", "");
    }
    
    // 혹은 "이미지 없음" 텍스트나 아이콘이 있는지 확인
    // expect(screen.getByText(/image not available/i)).toBeInTheDocument();
  });

  it("로딩 상태일 때 스켈레톤 UI가 표시되는지 검증", () => {
    render(<PokemonCard {...mockProps} isLoading={true} />);

    // 로딩 중일 때는 실제 이름이 보이지 않아야 함
    expect(screen.queryByText(/pikachu/i)).not.toBeInTheDocument();
    
    // 스켈레톤을 위한 특정 클래스나 aria-label이 있는지 확인
    // 예: animate-pulse 클래스 등
    const container = screen.getByTestId("pokemon-card"); // data-testid 필요
    expect(container).toHaveClass("animate-pulse");
  });
});
```

## 파일: .storybook/preview-head.html

```html
<!-- 
  Storybook iframe 내부에 추가적인 리소스를 주입합니다.
  주로 폰트나 외부 스타일시트를 로드하는 데 사용합니다.
-->

<!-- Inter 폰트 로드 (Next.js 기본 폰트) -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

<!-- 만약 별도의 CSS 변수 파일이 있다면 여기서 링크 가능 -->
<!-- <link rel="stylesheet" href="/path/to/custom-styles.css"> -->
```